# 糖都

## 项目描述

糖都农资电商系统。前端共 4 人完成了对前台以及服务站、供应商和管理后台总共四个端的开发。实行前后端分离，后台为单页应用；基于 react/dva 进行快速开发，使用 ant-design ui 库以及对其进行二次开发。

主要功能有：

1.  与硬件设备的交互（ic 卡的绑定、解绑、下单、支付、退单、订单打印,打印发票）
2.  接入高德地图用于展示
3.  实现数据统计可视化
4.  购物车模块使用本地存储技术

## 责任描述

1.  确定项目使用 react 全家桶配合 dva 进行模块化开发，提高开发效率和保证项目可维护性
    > 经过前两个项目的实践,发现这种组织架构易于快速开发后台单页应用，并且好维护
2.  搭建项目的基本框架，指定编码规范，使团队成员能快速进入开发
    > 接入 airbnb 代码规范，并与组员讨论，配置适合团队的编码规范，规定项目组织结构
3.  负责各端的购物车、商品、订单模块的编写，完成与后端的接口对接，配合后端的对接联调
    > localstorage 进行本地存储,请求商品详情更新本地购物车商品数量
4.  接入高德地图,实现地图展示；通过 recharts，实现数据统计可视化
5.  负责通用组件的编写和基于 ant-design 组件的二次开发，提高业务组件复用性，增强系统体验。

    > 通用库中的请求进行封装，对登录和权限做处理。二次开发组件 如多级城市筛选， ui 不同，操作流程不同，组合 input 组件；适用于业务的 table 组件二次开发；上传组件；编辑规格列表，穿梭框添加按钮；抽象 list/filter/modal 三个通用代码，按配置添加功能；封装订单详情组件

6.  利用 dva 提供的 model 层，解决多个页面中数据复用的问题
    > model 的设计是按功能来分的，而大多数后台管理页面的也是按功能来分。 例如后台很多页面需要用到商品分类数据数据，直接引用就好了
7.  通过后端渲染提升前台首页访问速度和用户体验

    > (负责解决前台首页前端进行多个请求调用，造成用户体验不佳的问题，通过修改前端减少请求和编写 php 调用数据、模板渲染数据，提升访问速度和用户体验。)
    >
    > * 因为起初后台是为了快速开发，只做了适用于 app 的一套接口，没有对首屏访问做优化,用户体验不好。因为对 php 也有很大兴趣，用 thinkphp 写过一个多商户商城，不过是 demo 级别的,比较熟悉 tp 的项目结构所以提出负责对此进行优化
    > * 负责解决前台首页前端进行多个请求调用，造成用户体验不佳的问题，通过修改前端减少请求和编写 php 调用数据、模板渲染数据，提升访问速度和用户体验。

8.  搭建基于 webpack 开发环境，实现接口代理，解决本地调试访问接口过慢的问题，提高开发调试效率；实现 css 预处理器、cssModule 的加载，解决组件复用性和全局命名的问题；配置优化打包，通过分包和按需加载，解决打包体积过大的问题，构建时间慢，加快资源加载速度

9)  负责协调工作和分配任务，保证项目进度
    > 与组员讨论并分配任务，

# 订单云

## 项目描述

智能化订单处理平台、b2b2c 系统。对 5 个端进行开发，分别有 pc 、微信、app 端。实行前后端分离开发，基础框架为 react/dva。代理商 app 端使用 react-native 进行快速开发，已上线 ios 和安卓应用市场。

实现的主要功能有：

1.  支付宝、微信的第三方认证、登录、支付和提现
2.  excel 表格的批量导入并实时进行修改和校验

## 责任描述

1.  基于 react 全家桶/dva 进行开发，解决 react/react-router/redux 中写法过于繁琐问题，提高开发效率
    > 上一个项目使用 redux，模板代码过多
2.  基于 ant-design、ant-design-mobile 组件的二次封装，增强用户体验性
    > * table 业务表单组件抽象封装
    > *
3.  编写各端的业务模块
4.  负责 代理商 app 端的开发，基于 react-native/dva ，ui 库为 ant-design-mobile，实现 android 端和 ios 端，并移植货源、发货模块至微信端；ios 端 app 上架商店操作
    > * 解决首次加载白屏问题
    > * 封装上传组件
    > * 实现虚拟键盘
    > * 接入第三方库，实现扫码，拍照截取图片，推送，微信登录，二维码生成，等功能
    > * 推送功能证书
    > * 提交审核
5.  负责接入支付宝和微信的支付、提现、认证、登录功能
    > app 端负责和 ios 和 andoird 开发人员进行接口设计和对接
    > web 端负责和后台人员进行对接
6.  解决开发表单实时校验和修改功能因数据过多出现卡顿的问题，通过查找 issue 和修改相应源码解决
    > 查 issue 定位为 shouldcomponentupdate 没有做优化，多次 render 引起卡顿
    >
    > * 限制表单数量，最多为 500 条
    > * 在 shouldcomponentupdate 做优化

webpack 相关

* 压缩,抽取公用 antd css,
* 提取公用 chunk
* 打包慢，通过命令 `--profile`（输出性能数据，可以看到每一步的耗时） `-display-modules` 发现 大多数都是在解析 `moment.js` 附带的大量本地化文件。所以定位慢的原因是 `moment` 引起的。
* 因为用的是 `roadhog 1.0`，发现官方没有好的实践，去查 antd 的 isusse,发现别人也有这种情况，解决方案是额外写一份 webpack 配置
* 打包过大，查 isusse,有网友推荐 然后大致看过打包后的文件发现 antd 组件的`css`公共部分没有被提取出来，通过`webpack-extract-text-plugin`进额外配置，提取公共 css 减少体积,通过设置`options.minimize`压缩体积；
* `roadhog 1.0`，官方没有没有写出单页如何抽取公用 chunk，通过`webpack.optimize.CommonChunksPlugin`配置;
* 实现接口代理，解决本地调试访问接口过慢的问题，提高开发调试效率；
* 实现 css 预处理器、cssModule 的加载，解决组件复用性和全局命名的问题；
* 配置优化打包，通过分包和按需加载，解决打包体积过大、构建时间慢等问题，加快资源加载速度

遇到难题，如何解决

1.  react-navigation 中 自定义 navigation 的返回最前一层 如订单页面跳到支付页面，成功后出栈 跳出到指定下单页面
2.  表单重复渲染 优化
